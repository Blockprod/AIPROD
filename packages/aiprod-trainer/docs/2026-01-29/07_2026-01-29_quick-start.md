# Quick Start Guide

Get up and running with AIPROD training in just a few steps!

## üìã Prerequisites

Before you begin, ensure you have:

1. **AIPROD Model Checkpoint** - A local `.safetensors` file containing the AIPROD model weights.
   Download `AIPROD-19b-dev.safetensors` from: [HuggingFace Hub](https://huggingface.co/Lightricks/AIPROD)
2. **AIPROD Text Encoder** - A local directory containing the AIPROD text encoder model (required for AIPROD).
   Available locally at: `models/text-encoder/`
3. **Linux with CUDA** - The trainer requires `triton` which is Linux-only
4. **GPU with sufficient VRAM** - 80GB recommended for the standard config. For GPUs with 32GB VRAM (e.g., RTX 5090),
   use the [low VRAM config](../configs/AIPROD2_av_lora_low_vram.yaml) which enables INT8 quantization and other
   memory optimizations

## ‚ö° Installation

First, install [uv](https://docs.astral.sh/uv/getting-started/installation/) if you haven't already.
Then clone the repository and install the dependencies:

```bash
git clone https://github.com/Lightricks/AIPROD
```

The `AIPROD-trainer` package is part of the `AIPROD` monorepo. Install the dependencies from the repository root,
then navigate to the trainer package:

```bash
# From the repository root
uv sync
cd packages/AIPROD-trainer
```

> [!NOTE]
> The trainer depends on [`AIPROD-core`](../../AIPROD-core/) and [`AIPROD-pipelines`](../../AIPROD-pipelines/)
> packages which are automatically installed from the monorepo.

## üèã Training Workflow

### 1. Prepare Your Dataset

Organize your videos and captions, then preprocess them:

```bash
# Split long videos into scenes (optional)
uv run python scripts/split_scenes.py input.mp4 scenes_output_dir/ --filter-shorter-than 5s

# Generate captions for videos (optional)
uv run python scripts/caption_videos.py scenes_output_dir/ --output dataset.json

# Preprocess the dataset (compute latents and embeddings)
uv run python scripts/process_dataset.py dataset.json \
    --resolution-buckets "960x544x49" \
    --model-path /path/to/AIPROD-model.safetensors \
    --text-encoder-path /path/to/aiprod-text-encoder
```

See [Dataset Preparation](dataset-preparation.md) for detailed instructions.

### 2. Configure Training

Create or modify a configuration YAML file. Start with one of the example configs:

- [`configs/AIPROD2_av_lora.yaml`](../configs/AIPROD2_av_lora.yaml) - Audio-video LoRA training
- [`configs/AIPROD2_av_lora_low_vram.yaml`](../configs/AIPROD2_av_lora_low_vram.yaml) - Audio-video LoRA training (optimized for 32GB VRAM)
- [`configs/AIPROD2_v2v_ic_lora.yaml`](../configs/AIPROD2_v2v_ic_lora.yaml) - IC-LoRA video-to-video

Key settings to update:

```yaml
model:
  model_path: "/path/to/AIPROD-model.safetensors"
  text_encoder_path: "/path/to/aiprod-text-encoder"

data:
  preprocessed_data_root: "/path/to/preprocessed/data"

output_dir: "outputs/my_training_run"
```

See [Configuration Reference](configuration-reference.md) for all available options.

### 3. Start Training

```bash
uv run python scripts/train.py configs/AIPROD2_av_lora.yaml
```

For multi-GPU training:

```bash
uv run accelerate launch scripts/train.py configs/AIPROD2_av_lora.yaml
```

See [Training Guide](training-guide.md) for distributed training and advanced options.

## üéØ Training Modes

The trainer supports several training modes:

| Mode                 | Description                    | Config Example                             |
|----------------------|--------------------------------|--------------------------------------------|
| **LoRA**             | Efficient adapter training     | `training_strategy.name: "text_to_video"`  |
| **Audio-Video LoRA** | Joint audio-video training     | `training_strategy.with_audio: true`       |
| **IC-LoRA**          | Video-to-video transformations | `training_strategy.name: "video_to_video"` |
| **Full Fine-tuning** | Full model training            | `model.training_mode: "full"`              |

See [Training Modes](training-modes.md) for detailed explanations,
or [Custom Training Strategies](custom-training-strategies.md) if you need to implement your own training recipe.

## Next Steps

Once you've completed your first training run, you can:

- **Use your trained LoRA for inference** - The [`AIPROD-pipelines`](../../AIPROD-pipelines/) package provides
  production-ready inference
  pipelines for various use cases (T2V, I2V, IC-LoRA, etc.). See the package documentation for details.
- Learn more about [Dataset Preparation](dataset-preparation.md) for advanced preprocessing
- Explore different [Training Modes](training-modes.md) (LoRA, Audio-Video, IC-LoRA)
- Dive deeper into [Training Configuration](configuration-reference.md)
- Understand the model architecture in [AIPROD-Core Documentation](../../AIPROD-core/README.md)

## Need Help?

If you run into issues at any step, see the [Troubleshooting Guide](troubleshooting.md) for solutions to common
problems.

Join our [Discord community](https://discord.gg/AIPRODplatform) for real-time help and discussion!
